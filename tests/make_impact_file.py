import numpy as np


im_file="ImpactsHadean2.dat"

im_ages = np.genfromtxt(im_file,usecols=0)
lon = np.genfromtxt(im_file,usecols=1)
lat = np.genfromtxt(im_file,usecols=2)
R = np.genfromtxt(im_file,usecols=3)
vel = np.genfromtxt(im_file,usecols=4)

f1 = im_ages>=400.0

im_ages2 = im_ages[f1]
lon2 = lon[f1]
lat2 = lat[f1]
R2 = R[f1]
vel2 = vel[f1]

f2 = ( (lat2 <=10.0)&(lat2>=-10.0))

im_ages3 = im_ages2[f2]
lon3 = lon2[f2]
lat3 = lat2[f2]
R3 = R2[f2]
vel3 = vel2[f2]

# Radius of Earth at equator is 40,075 km. 
# Modelling domain is 1320 km, or 0.033 of it, or 11.88 deg arc. 
#Try a few
l1=0.0
l2=12.0
print("Lons:",l1,l2)
lon3 += 180

while l2 <=360:
    f3 = ( (lon3 >= l1) & (lon3 <= l2))
    print("Lons:",l1,l2,"Ages:",im_ages3[f3],"Radii:",R3[f3])
    if (l1 == 204):
        l3 = lon3[f3]-204
        np.savetxt("Impacts_lon204.dat",np.c_[im_ages3[f3],l3,lat3[f3],R3[f3],vel3[f3]])
    l1 +=12
    l2 +=12


# Results
"""
Lons: 0.0 12.0 Ages: [416.7995 514.8642 521.0725 542.0798 838.1702] Radii: [  77.193    72.256  1892.6546   78.8993  108.3714]
Lons: 12.0 24.0 Ages: [496.1119] Radii: [231.9209]
Lons: 24.0 36.0 Ages: [481.1123 510.8787 519.9919] Radii: [97.6874 73.0361 72.3585]
Lons: 36.0 48.0 Ages: [592.1501 611.5174] Radii: [236.6178 107.0067]
Lons: 48.0 60.0 Ages: [424.2378 462.9114 787.4818 929.0674] Radii: [106.171   76.5375 236.5609 246.0042]
Lons: 60.0 72.0 Ages: [449.9447 462.6398 466.9174 615.3984 636.5344 733.7103] Radii: [ 69.1542 141.2648 128.8421  81.0272  72.9566  76.442 ]
Lons: 72.0 84.0 Ages: [407.5737 438.5145 447.9915 669.5099] Radii: [ 85.8133  84.2889 116.6923  93.0743]
Lons: 84.0 96.0 Ages: [501.4185 572.6645] Radii: [86.3872 79.2679]
Lons: 96.0 108.0 Ages: [446.6552 449.1273 657.8802] Radii: [ 69.6505  69.2125 187.3253]

Lons: 108.0 120.0 Ages: [467.8272 478.144  482.1665 564.6122 595.6352 775.7866] Radii: [128.2967  88.1719  92.1921  98.7333 170.9701 248.4155]

Lons: 120.0 132.0 Ages: [415.7335 456.998  509.8172 519.0577 597.8384 606.8034 704.2796] Radii: [ 121.3552  112.1566   68.7145  135.8475   74.7175   79.843  1873.2121]
Lons: 132.0 144.0 Ages: [418.2768 426.6718 581.1403] Radii: [ 95.8755 144.8639 109.0778]
Lons: 144.0 156.0 Ages: [482.7021 497.8096 545.3679 624.0048 699.9801] Radii: [ 95.4706  71.9258 113.9888  91.5887  74.6064]
Lons: 156.0 168.0 Ages: [458.0247 469.9123 609.6549] Radii: [ 92.8214 286.262  448.0618]
Lons: 168.0 180.0 Ages: [410.7094 412.234  429.7911 537.7645 562.0331 593.5681 709.76  ] Radii: [  83.5545   88.4962  110.7453 2087.5764 2005.9701  112.7199   71.0786]
Lons: 180.0 192.0 Ages: [465.1111 504.0575 514.5436] Radii: [278.0983  71.0069 255.139 ]
Lons: 192.0 204.0 Ages: [499.059  586.1701 602.4143 818.7433] Radii: [ 92.7142  82.8174 245.7757 118.9479]

Lons: 204.0 216.0 Ages: [452.8714 455.5342 464.8265 488.9172] Radii: [68.8755 70.7769 79.6816 84.0917]

Lons: 216.0 228.0 Ages: [401.6705 410.3467 473.4719 711.878 ] Radii: [ 84.4271 131.337   93.8017  74.5042]
Lons: 228.0 240.0 Ages: [486.442  535.0161 687.5801 707.1347] Radii: [ 79.0907  84.8007  94.4548 346.718 ]
Lons: 240.0 252.0 Ages: [585.2036 631.6659] Radii: [ 88.4162 285.9551]
Lons: 252.0 264.0 Ages: [480.6437 523.3174] Radii: [112.1337  72.4457]
Lons: 264.0 276.0 Ages: [403.2469 452.6768 453.2122 586.2363 772.8017] Radii: [  75.9274  124.8585   70.5143 2987.9191  138.0373]
Lons: 276.0 288.0 Ages: [431.7497 494.239  543.9494 800.9814] Radii: [ 88.8624 161.3673  72.3803  82.5919]
Lons: 288.0 300.0 Ages: [487.6362] Radii: [77.4462]
Lons: 300.0 312.0 Ages: [587.805] Radii: [84.168]
Lons: 312.0 324.0 Ages: [ 504.0684  746.9018 1060.8074] Radii: [99.6377 80.7491 68.1656]
Lons: 324.0 336.0 Ages: [443.6552 445.0172 547.293  802.6872] Radii: [151.0856 188.1159  72.6843 127.0901]

Lons: 336.0 348.0 Ages: [403.6187 404.3315 494.1235 797.2837] Radii: [67.8025 79.3144 83.0041 88.1236]

Lons: 348.0 360.0 Ages: [406.1143 406.2786 476.079 ] Radii: [69.3264 73.2662 74.4467]
"""
###
